<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>String Storage on Blockchain</title>
    <script src="https://cdn.jsdelivr.net/npm/web3/dist/web3.min.js"></script>
</head>
<body>
    <h1>Blockchain String Storage</h1>
    <input type="text" id="stringValue" placeholder="Enter string">
    <button onclick="addString()">Add String</button>
    <button onclick="getStrings()">Get Strings</button>
    <p id="stringsOutput"></p>

    <script>
        // Initialize web3 instance
        const web3 = new Web3('https://rinkeby.infura.io/v3/YOUR_INFURA_PROJECT_ID');
        
        // Check connection
        web3.eth.getChainId()
            .then(chainId => console.log("Connected to Chain ID:", chainId))
            .catch(error => console.error("Connection error:", error));

        // Contract details
        const contractAddress = 'YOUR_DEPLOYED_CONTRACT_ADDRESS';
        const abi = [
            {
                "constant": true,
                "inputs": [{"internalType": "uint256", "name": "", "type": "uint256"}],
                "name": "strings",
                "outputs": [{"internalType": "string", "name": "", "type": "string"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": false,
                "inputs": [{"internalType": "string", "name": "input", "type": "string"}],
                "name": "addString",
                "outputs": [],
                "payable": false,
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [{"internalType": "uint256", "name": "index", "type": "uint256"}],
                "name": "getString",
                "outputs": [{"internalType": "string", "name": "", "type": "string"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            },
            {
                "constant": true,
                "inputs": [],
                "name": "getAllStrings",
                "outputs": [{"internalType": "string[]", "name": "", "type": "string[]"}],
                "payable": false,
                "stateMutability": "view",
                "type": "function"
            }
        ];
        const contract = new web3.eth.Contract(abi, contractAddress);

        async function addString() {
            const stringValue = document.getElementById('stringValue').value;
            console.log('hi');
            try {
                console.log('hallo');
                const accounts = await web3.eth.getAccounts();
                if (accounts.length === 0) {
            throw new Error('No accounts found. Please check your Web3 provider.');
        }
                console.log('bye');
                const result = await contract.methods.addString(stringValue).send({ from: accounts[0] });
                console.log(result);
                alert('String added successfully!');
            } catch (error) {
                console.error('Error adding string:', error);
                alert('Error adding string: ' + error.message);
            }
        }

        async function getStrings() {
            try {
                const result = await contract.methods.getAllStrings().call();
                document.getElementById('stringsOutput').innerText = 'Stored Strings: ' + result.join(', ');
            } catch (error) {
                console.error('Error fetching strings:', error);
                alert('Error fetching strings: ' + error.message);
            }
        }
    </script>
</body>
</html>
